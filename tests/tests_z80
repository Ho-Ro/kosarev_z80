
#   Z80 CPU Emulator.
#   https://github.com/kosarev/z80
#
#   Copyright (c) 2017 Ivan Kosarev <ivan@kosarev.info>
#   Published under the MIT license.


# ADD r
87 add a, a
 0 m1_fetch
 0   fetch 87 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 get_a 00
 4 get_a 00
 4 set_a 00 -> 00
 4 set_f 00 -> 40
 4 done

# ADD A, n
c616 add a, 0x16
 0 m1_fetch
 0   fetch c6 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 imm8_read 16 at 0001
 4   get_pc_on_imm8_read 0001
 4   read 16 at 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 7   set_pc_on_imm8_read 0001 -> 0002
 7 get_a 00
 7 set_a 00 -> 16
 7 set_f 00 -> 00
 7 done

# ADD HL, rp
19 add hl, de
 0 m1_fetch
 0   fetch 19 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 get_l 00
 4 get_h 00
 4 get_e 00
 4 get_d 00
 4 get_f 00
 4 4t_exec
 8 3t_exec
11 set_wz 0000 -> 0001
11 set_l 00 -> 00
11 set_h 00 -> 00
11 set_f 00 -> 00
11 done

# ADC A, r
89 adc a, c
 0 m1_fetch
 0   fetch 89 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 get_c 00
 4 get_a 00
 4 get_f 00
 4 set_a 00 -> 00
 4 set_f 00 -> 40
 4 done

# ADC HL, rp
ed5a adc hl, de
 0 m1_fetch
 0   fetch ed at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 m1_fetch
 4   fetch 5a at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 get_l 00
 8 get_h 00
 8 get_e 00
 8 get_d 00
 8 get_f 00
 8 4t_exec
12 3t_exec
15 set_wz 0000 -> 0001
15 set_l 00 -> 00
15 set_h 00 -> 00
15 set_f 00 -> 40
15 done

# AND r
a7 and a
 0 m1_fetch
 0   fetch a7 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 get_a 00
 4 get_a 00
 4 set_a 00 -> 00
 4 set_f 00 -> 54
 4 done

# BIT b, r
fdcb014e bit 1, (iy + 1)
 0 m1_fetch
 0   fetch fd at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 set_index_rp hl -> iy
 4 disable_int
 4 m1_fetch
 4   fetch cb at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 disp_read 01 at 0002
 8   get_pc_on_disp_read 0002
 8   read 01 at 0002
 8     set_addr_bus 0001 -> 0002
10     mreq_wait 0002
11   set_pc_on_disp_read 0002 -> 0003
11 fetch 4e at 0003
11   get_pc_on_fetch 0003
11   set_addr_bus 0002 -> 0003
13   mreq_wait 0003
13   get_ir_on_refresh 0002
13   set_addr_bus 0003 -> 0002
15   set_pc_on_fetch 0003 -> 0004
15 fetch_cycle_extra_1t
16 get_iyl 00
16 get_iyh 00
16 read cb at 0001
16   set_addr_bus 0002 -> 0001
18   mreq_wait 0001
19 read_cycle_extra_1t
20 set_wz 0000 -> 0001
20 get_f 00
20 set_f 00 -> 10
20 set_index_rp iy -> hl
20 done

# CALL nn
cddf0e call 0x0edf
 0 m1_fetch
 0   fetch cd at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 imm16_read 0edf at 0001
 4   get_pc_on_imm16_read 0001
 4   read df at 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 7   read 0e at 0002
 7     set_addr_bus 0001 -> 0002
 9     mreq_wait 0002
10   set_pc_on_imm16_read 0001 -> 0003
10 read_cycle_extra_1t
11 get_sp 0000
11 write 00 -> 00 at ffff
11   set_addr_bus 0002 -> ffff
13   mreq_wait ffff
14 write 00 -> 03 at fffe
14   set_addr_bus ffff -> fffe
16   mreq_wait fffe
17 set_sp 0000 -> fffe
17 set_wz 0000 -> 0edf
17 set_pc_on_call 0003 -> 0edf
17 done

# CALL cc, nn
c4550c call nz, 0x0c55
 0 m1_fetch
 0   fetch c4 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 imm16_read 0c55 at 0001
 4   get_pc_on_imm16_read 0001
 4   read 55 at 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 7   read 0c at 0002
 7     set_addr_bus 0001 -> 0002
 9     mreq_wait 0002
10   set_pc_on_imm16_read 0001 -> 0003
10 get_f 00
10 read_cycle_extra_1t
11 get_sp 0000
11 write 00 -> 00 at ffff
11   set_addr_bus 0002 -> ffff
13   mreq_wait ffff
14 write 00 -> 03 at fffe
14   set_addr_bus ffff -> fffe
16   mreq_wait fffe
17 set_sp 0000 -> fffe
17 set_wz 0000 -> 0c55
17 set_pc_on_call 0003 -> 0c55
17 done

# CCF
3f ccf
 0 m1_fetch
 0   fetch 3f at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 get_a 00
 4 get_f 00
 4 set_f 00 -> 01
 4 done

# CP r
bc cp h
 0 m1_fetch
 0   fetch bc at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 get_h 00
 4 get_a 00
 4 set_f 00 -> 42
 4 done

# CPIR
edb1 cpir
 0 m1_fetch
 0   fetch ed at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 m1_fetch
 4   fetch b1 at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 get_c 00
 8 get_b 00
 8 get_l 00
 8 get_h 00
 8 get_a 00
 8 get_f 00
 8 read ed at 0000
 8   set_addr_bus 0001 -> 0000
10   mreq_wait 0000
11 5t_exec
16 set_c 00 -> ff
16 set_b 00 -> ff
16 set_wz 0000 -> 0001
16 set_l 00 -> 01
16 set_h 00 -> 00
16 set_f 00 -> 36
16 5t_exec
21 get_pc_on_block_instr 0002
21 set_wz 0001 -> 0001
21 set_pc_on_block_instr 0002 -> 0000
21 done

# CPL
2f cpl
 0 m1_fetch
 0   fetch 2f at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 get_a 00
 4 get_f 00
 4 set_a 00 -> ff
 4 set_f 00 -> 3a
 4 done

# DAA
27 daa
 0 m1_fetch
 0   fetch 27 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 get_a 00
 4 get_f 00
 4 set_a 00 -> 00
 4 set_f 00 -> 44
 4 done

# DEC r
35 dec (hl)
 0 m1_fetch
 0   fetch 35 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 get_l 00
 4 get_h 00
 4 read 35 at 0000
 4   set_addr_bus 0000 -> 0000
 6   mreq_wait 0000
 7 read_cycle_extra_1t
 8 get_f 00
 8 get_l 00
 8 get_h 00
 8 write 35 -> 34 at 0000
 8   set_addr_bus 0000 -> 0000
10   mreq_wait 0000
11 set_f 00 -> 22
11 done

# DEC rp
2b dec hl
 0 m1_fetch
 0   fetch 2b at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 fetch_cycle_extra_2t
 6 get_l 00
 6 get_h 00
 6 set_l 00 -> ff
 6 set_h 00 -> ff
 6 done

# DI
f3 di
 0 m1_fetch
 0   fetch f3 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 set_iff1_on_di 0 -> 0
 4 set_iff2_on_di 0 -> 0
 4 done

# DJNZ d
10fc djnz $ - 2
 0 m1_fetch
 0   fetch 10 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 fetch_cycle_extra_1t
 5 disp_read fc at 0001
 5   get_pc_on_disp_read 0001
 5   read fc at 0001
 5     set_addr_bus 0000 -> 0001
 7     mreq_wait 0001
 8   set_pc_on_disp_read 0001 -> 0002
 8 get_b 00
 8 set_b 00 -> ff
 8 5t_exec
13 get_pc_on_jump 0002
13 set_wz 0000 -> fffe
13 set_pc_on_jump 0002 -> fffe
13 done

# EI
fb ei
 0 m1_fetch
 0   fetch fb at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 set_iff1_on_ei 0 -> 1
 4 set_iff2_on_ei 0 -> 1
 4 disable_int
 4 done

# EX AF, AF'
08 ex af, af'
 0 m1_fetch
 0   fetch 08 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 done

# EX DE, HL
eb ex de, hl
 0 m1_fetch
 0   fetch eb at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 done

# EX (SP), irp
e3 ex (sp), hl
 0 m1_fetch
 0   fetch e3 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 get_sp 0000
 4 read e3 at 0000
 4   set_addr_bus 0000 -> 0000
 6   mreq_wait 0000
 7 read 00 at 0001
 7   set_addr_bus 0000 -> 0001
 9   mreq_wait 0001
10 read_cycle_extra_1t
11 get_l 00
11 get_h 00
11 write 00 -> 00 at 0001
11   set_addr_bus 0001 -> 0001
13   mreq_wait 0001
14 write e3 -> 00 at 0000
14   set_addr_bus 0001 -> 0000
16   mreq_wait 0000
17 write_cycle_extra_2t
19 set_wz 0000 -> 00e3
19 set_l 00 -> e3
19 set_h 00 -> 00
19 done

# EXX
d9 exx
 0 m1_fetch
 0   fetch d9 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 done

# HALT
76 halt
 0 m1_fetch
 0   fetch 76 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 get_pc_on_halt 0001
 4 set_pc_on_halt 0001 -> 0000
 4 done

# IM n
ed56 im 1
 0 m1_fetch
 0   fetch ed at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 m1_fetch
 4   fetch 56 at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 set_int_mode 0 -> 1
 8 done

ed46 im 0
ed5e im 2
ed4e xim 0x4e, 0
ed66 xim 0x66, 0
ed6e xim 0x6e, 0
ed76 xim 0x76, 1
ed7e xim 0x7e, 2

# INC r
04 inc b
 0 m1_fetch
 0   fetch 04 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 get_b 00
 4 get_f 00
 4 set_b 00 -> 01
 4 set_f 00 -> 00
 4 done

# INC rp
23 inc hl
 0 m1_fetch
 0   fetch 23 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 fetch_cycle_extra_2t
 6 get_l 00
 6 get_h 00
 6 set_l 00 -> 01
 6 set_h 00 -> 00
 6 done

# IN A, (n)
dbfe in a, (0xfe)
 0 m1_fetch
 0   fetch db at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 imm8_read fe at 0001
 4   get_pc_on_imm8_read 0001
 4   read fe at 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 7   set_pc_on_imm8_read 0001 -> 0002
 7 get_a 00
 7 set_wz 0000 -> 00ff
 7 input at 00fe
 7   set_addr_bus 0001 -> 00fe
10   iorq_wait 00fe
11 set_a 00 -> ff
11 done

# IN r, (C)
ed78 in a, (c)
 0 m1_fetch
 0   fetch ed at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 m1_fetch
 4   fetch 78 at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 get_c 00
 8 get_b 00
 8 get_f 00
 8 set_wz 0000 -> 0001
 8 input at 0000
 8   set_addr_bus 0001 -> 0000
11   iorq_wait 0000
12 set_a 00 -> ff
12 set_f 00 -> ac
12 done

# JP cc, nn
d2d90a jp nc, 0x0ad9
 0 m1_fetch
 0   fetch d2 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 imm16_read 0ad9 at 0001
 4   get_pc_on_imm16_read 0001
 4   read d9 at 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 7   read 0a at 0002
 7     set_addr_bus 0001 -> 0002
 9     mreq_wait 0002
10   set_pc_on_imm16_read 0001 -> 0003
10 get_f 00
10 set_wz 0000 -> 0ad9
10 set_pc_on_jump 0003 -> 0ad9
10 done

# JP irp
e9 jp (hl)
 0 m1_fetch
 0   fetch e9 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 get_l 00
 4 get_h 00
 4 set_pc_on_jump 0001 -> 0000
 4 done

# JP nn
c3cdab jp 0xabcd
 0 m1_fetch
 0   fetch c3 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 imm16_read abcd at 0001
 4   get_pc_on_imm16_read 0001
 4   read cd at 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 7   read ab at 0002
 7     set_addr_bus 0001 -> 0002
 9     mreq_wait 0002
10   set_pc_on_imm16_read 0001 -> 0003
10 set_wz 0000 -> abcd
10 set_pc_on_jump 0003 -> abcd
10 done

# JR d
1804 jr $ + 6
 0 m1_fetch
 0   fetch 18 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 disp_read 04 at 0001
 4   get_pc_on_disp_read 0001
 4   read 04 at 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 7   set_pc_on_disp_read 0001 -> 0002
 7 5t_exec
12 get_pc_on_jump 0002
12 set_wz 0000 -> 0006
12 set_pc_on_jump 0002 -> 0006
12 done

# JR cc, d
28fa jr z, $ - 4
 0 m1_fetch
 0   fetch 28 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 disp_read fa at 0001
 4   get_pc_on_disp_read 0001
 4   read fa at 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 7   set_pc_on_disp_read 0001 -> 0002
 7 get_f 00
 7 done

200a jr nz, $ + 12
 0 m1_fetch
 0   fetch 20 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 disp_read 0a at 0001
 4   get_pc_on_disp_read 0001
 4   read 0a at 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 7   set_pc_on_disp_read 0001 -> 0002
 7 get_f 00
 7 5t_exec
12 get_pc_on_jump 0002
12 set_wz 0000 -> 000c
12 set_pc_on_jump 0002 -> 000c
12 done

# LD A, I
ed57 ld a, i
 0 m1_fetch
 0   fetch ed at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 m1_fetch
 4   fetch 57 at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 fetch_cycle_extra_1t
 9 get_f 00
 9 set_a 00 -> 00
 9 set_f 00 -> 40
 9 done

# LD A, R
ed5f ld a, r
 0 m1_fetch
 0   fetch ed at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 m1_fetch
 4   fetch 5f at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 fetch_cycle_extra_1t
 9 get_f 00
 9 set_a 00 -> 02
 9 set_f 00 -> 00
 9 done

# LD r, a
ed4f ld r, a
 0 m1_fetch
 0   fetch ed at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 m1_fetch
 4   fetch 4f at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 fetch_cycle_extra_1t
 9 get_a 00
 9 set_r 02 -> 00
 9 done

# LD r, r
47 ld b, a
 0 m1_fetch
 0   fetch 47 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 get_a 00
 4 set_b 00 -> 00
 4 done

dd6b ld ixl, e
 0 m1_fetch
 0   fetch dd at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 set_index_rp hl -> ix
 4 disable_int
 4 m1_fetch
 4   fetch 6b at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 get_e 00
 8 set_ixl 00 -> 00
 8 set_index_rp ix -> hl
 8 done

# 0x6e LD L,(REGISTER+dd)
fd6e12 ld l, (iy + 18)
 0 m1_fetch
 0   fetch fd at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 set_index_rp hl -> iy
 4 disable_int
 4 m1_fetch
 4   fetch 6e at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 disp_read 12 at 0002
 8   get_pc_on_disp_read 0002
 8   read 12 at 0002
 8     set_addr_bus 0001 -> 0002
10     mreq_wait 0002
11   set_pc_on_disp_read 0002 -> 0003
11 5t_exec
16 get_iyl 00
16 get_iyh 00
16 read 00 at 0012
16   set_addr_bus 0002 -> 0012
18   mreq_wait 0012
19 set_wz 0000 -> 0012
19 set_l 00 -> 00
19 set_index_rp iy -> hl
19 done

# LD r, n
3eaf ld a, 0xaf
 0 m1_fetch
 0   fetch 3e at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 imm8_read af at 0001
 4   get_pc_on_imm8_read 0001
 4   read af at 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 7   set_pc_on_imm8_read 0001 -> 0002
 7 set_a 00 -> af
 7 done

3602 ld (hl), 0x02
 0 m1_fetch
 0   fetch 36 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 imm8_read 02 at 0001
 4   get_pc_on_imm8_read 0001
 4   read 02 at 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 7   set_pc_on_imm8_read 0001 -> 0002
 7 get_l 00
 7 get_h 00
 7 write 36 -> 02 at 0000
 7   set_addr_bus 0001 -> 0000
 9   mreq_wait 0000
10 done

# LD I, A
ed47 ld i, a
 0 m1_fetch
 0   fetch ed at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 m1_fetch
 4   fetch 47 at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 fetch_cycle_extra_1t
 9 get_a 00
 9 set_i 00 -> 00
 9 done

# LD rp, nn
115634 ld de, 0x3456
 0 m1_fetch
 0   fetch 11 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 imm16_read 3456 at 0001
 4   get_pc_on_imm16_read 0001
 4   read 56 at 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 7   read 34 at 0002
 7     set_addr_bus 0001 -> 0002
 9     mreq_wait 0002
10   set_pc_on_imm16_read 0001 -> 0003
10 set_e 00 -> 56
10 set_d 00 -> 34
10 done

fd213a5c ld iy, 0x5c3a
 0 m1_fetch
 0   fetch fd at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 set_index_rp hl -> iy
 4 disable_int
 4 m1_fetch
 4   fetch 21 at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 imm16_read 5c3a at 0002
 8   get_pc_on_imm16_read 0002
 8   read 3a at 0002
 8     set_addr_bus 0001 -> 0002
10     mreq_wait 0002
11   read 5c at 0003
11     set_addr_bus 0002 -> 0003
13     mreq_wait 0003
14   set_pc_on_imm16_read 0002 -> 0004
14 set_iyl 00 -> 3a
14 set_iyh 00 -> 5c
14 set_index_rp iy -> hl
14 done

dd21d103 ld ix, 0x03d1
 0 m1_fetch
 0   fetch dd at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 set_index_rp hl -> ix
 4 disable_int
 4 m1_fetch
 4   fetch 21 at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 imm16_read 03d1 at 0002
 8   get_pc_on_imm16_read 0002
 8   read d1 at 0002
 8     set_addr_bus 0001 -> 0002
10     mreq_wait 0002
11   read 03 at 0003
11     set_addr_bus 0002 -> 0003
13     mreq_wait 0003
14   set_pc_on_imm16_read 0002 -> 0004
14 set_ixl 00 -> d1
14 set_ixh 00 -> 03
14 set_index_rp ix -> hl
14 done

# LD rp, (nn)
ed4bb45c ld bc, (0x5cb4)
 0 m1_fetch
 0   fetch ed at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 m1_fetch
 4   fetch 4b at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 imm16_read 5cb4 at 0002
 8   get_pc_on_imm16_read 0002
 8   read b4 at 0002
 8     set_addr_bus 0001 -> 0002
10     mreq_wait 0002
11   read 5c at 0003
11     set_addr_bus 0002 -> 0003
13     mreq_wait 0003
14   set_pc_on_imm16_read 0002 -> 0004
14 read 00 at 5cb4
14   set_addr_bus 0003 -> 5cb4
16   mreq_wait 5cb4
17 set_wz 0000 -> 5cb5
17 read 00 at 5cb5
17   set_addr_bus 5cb4 -> 5cb5
19   mreq_wait 5cb5
20 set_c 00 -> 00
20 set_b 00 -> 00
20 done

# LD irp, (nn)
2ab25c ld hl, (0x5cb2)
 0 m1_fetch
 0   fetch 2a at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 imm16_read 5cb2 at 0001
 4   get_pc_on_imm16_read 0001
 4   read b2 at 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 7   read 5c at 0002
 7     set_addr_bus 0001 -> 0002
 9     mreq_wait 0002
10   set_pc_on_imm16_read 0001 -> 0003
10 read 00 at 5cb2
10   set_addr_bus 0002 -> 5cb2
12   mreq_wait 5cb2
13 set_wz 0000 -> 5cb3
13 read 00 at 5cb3
13   set_addr_bus 5cb2 -> 5cb3
15   mreq_wait 5cb3
16 set_l 00 -> 00
16 set_h 00 -> 00
16 done

# LD A, (nn)
3a8d5c ld a, (0x5c8d)
 0 m1_fetch
 0   fetch 3a at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 imm16_read 5c8d at 0001
 4   get_pc_on_imm16_read 0001
 4   read 8d at 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 7   read 5c at 0002
 7     set_addr_bus 0001 -> 0002
 9     mreq_wait 0002
10   set_pc_on_imm16_read 0001 -> 0003
10 set_wz 0000 -> 5c8e
10 read 00 at 5c8d
10   set_addr_bus 0002 -> 5c8d
12   mreq_wait 5c8d
13 set_a 00 -> 00
13 done

# LD (nn), A
328d5c ld (0x5c8d), a
 0 m1_fetch
 0   fetch 32 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 imm16_read 5c8d at 0001
 4   get_pc_on_imm16_read 0001
 4   read 8d at 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 7   read 5c at 0002
 7     set_addr_bus 0001 -> 0002
 9     mreq_wait 0002
10   set_pc_on_imm16_read 0001 -> 0003
10 get_a 00
10 set_wz 0000 -> 008e
10 write 00 -> 00 at 5c8d
10   set_addr_bus 0002 -> 5c8d
12   mreq_wait 5c8d
13 done

# LD (nn), irp
227b5c ld (0x5c7b), hl
 0 m1_fetch
 0   fetch 22 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 imm16_read 5c7b at 0001
 4   get_pc_on_imm16_read 0001
 4   read 7b at 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 7   read 5c at 0002
 7     set_addr_bus 0001 -> 0002
 9     mreq_wait 0002
10   set_pc_on_imm16_read 0001 -> 0003
10 get_l 00
10 get_h 00
10 write 00 -> 00 at 5c7b
10   set_addr_bus 0002 -> 5c7b
12   mreq_wait 5c7b
13 set_wz 0000 -> 5c7c
13 write 00 -> 00 at 5c7c
13   set_addr_bus 5c7b -> 5c7c
15   mreq_wait 5c7c
16 done

# LD (nn), rp
ed43b45c ld (0x5cb4), bc
 0 m1_fetch
 0   fetch ed at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 m1_fetch
 4   fetch 43 at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 imm16_read 5cb4 at 0002
 8   get_pc_on_imm16_read 0002
 8   read b4 at 0002
 8     set_addr_bus 0001 -> 0002
10     mreq_wait 0002
11   read 5c at 0003
11     set_addr_bus 0002 -> 0003
13     mreq_wait 0003
14   set_pc_on_imm16_read 0002 -> 0004
14 get_c 00
14 get_b 00
14 write 00 -> 00 at 5cb4
14   set_addr_bus 0003 -> 5cb4
16   mreq_wait 5cb4
17 set_wz 0000 -> 5cb5
17 write 00 -> 00 at 5cb5
17   set_addr_bus 5cb4 -> 5cb5
19   mreq_wait 5cb5
20 done

# LD A, (rp)
1a ld a, (de)
 0 m1_fetch
 0   fetch 1a at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 get_e 00
 4 get_d 00
 4 set_wz 0000 -> 0001
 4 read 1a at 0000
 4   set_addr_bus 0000 -> 0000
 6   mreq_wait 0000
 7 set_a 00 -> 1a
 7 done

# LD (rp), A
12 ld (de), a
 0 m1_fetch
 0   fetch 12 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 get_e 00
 4 get_d 00
 4 get_a 00
 4 set_wz 0000 -> 0001
 4 write 12 -> 00 at 0000
 4   set_addr_bus 0000 -> 0000
 6   mreq_wait 0000
 7 done

# LD SP, irp
f9 ld sp, hl
 0 m1_fetch
 0   fetch f9 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 fetch_cycle_extra_2t
 6 get_l 00
 6 get_h 00
 6 set_sp 0000 -> 0000
 6 done

# Block transfers.
edb8 lddr
 0 m1_fetch
 0   fetch ed at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 m1_fetch
 4   fetch b8 at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 get_c 00
 8 get_b 00
 8 get_e 00
 8 get_d 00
 8 get_l 00
 8 get_h 00
 8 get_a 00
 8 get_f 00
 8 read ed at 0000
 8   set_addr_bus 0001 -> 0000
10   mreq_wait 0000
11 write ed -> ed at 0000
11   set_addr_bus 0000 -> 0000
13   mreq_wait 0000
14 write_cycle_extra_2t
16 set_c 00 -> ff
16 set_b 00 -> ff
16 set_e 00 -> ff
16 set_d 00 -> ff
16 set_l 00 -> ff
16 set_h 00 -> ff
16 set_f 00 -> 0c
16 5t_exec
21 get_pc_on_block_instr 0002
21 set_wz 0000 -> 0001
21 set_pc_on_block_instr 0002 -> 0000
21 done

# NEG
ed44 neg
 0 m1_fetch
 0   fetch ed at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 m1_fetch
 4   fetch 44 at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 get_a 00
 8 get_f 00
 8 set_a 00 -> 00
 8 set_f 00 -> 42
 8 done

ed4c xneg 0x4c
ed7c xneg 0x7c

# NOP
00 nop
 0 m1_fetch
 0   fetch 00 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 done

ed00 xnop 0xed00
ed3f xnop 0xed3f
ed77 xnop 0xed77
ed7f xnop 0xed7f
ed80 xnop 0xed80
ed87 xnop 0xed87
ed9f xnop 0xed9f
eda4 xnop 0xeda4
eda7 xnop 0xeda7
edac xnop 0xedac
edaf xnop 0xedaf
edb4 xnop 0xedb4
edb7 xnop 0xedb7
edbc xnop 0xedbc
edbf xnop 0xedbf
edc0 xnop 0xedc0
edff xnop 0xedff

# OR r
b3 or e
 0 m1_fetch
 0   fetch b3 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 get_e 00
 4 get_a 00
 4 set_a 00 -> 00
 4 set_f 00 -> 44
 4 done

# OUT (C), r
ed79 out (c), a
 0 m1_fetch
 0   fetch ed at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 m1_fetch
 4   fetch 79 at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 get_c 00
 8 get_b 00
 8 set_wz 0000 -> 0001
 8 get_a 00
 8 output 00 at 0000
 8   set_addr_bus 0001 -> 0000
11   iorq_wait 0000
12 done

# Block input.
edb2 inir
 0 m1_fetch
 0   fetch ed at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 m1_fetch
 4   fetch b2 at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 get_c 00
 8 get_b 00
 8 get_l 00
 8 get_h 00
 8 get_f 00
 8 fetch_cycle_extra_1t
 9 input at ff00
 9   set_addr_bus 0001 -> ff00
12   iorq_wait ff00
13 write ed -> ff at 0000
13   set_addr_bus ff00 -> 0000
15   mreq_wait 0000
16 set_c 00 -> 00
16 set_b 00 -> ff
16 set_wz 0000 -> ff01
16 set_l 00 -> 01
16 set_h 00 -> 00
16 set_f 00 -> bf
16 5t_exec
21 get_pc_on_block_instr 0002
21 set_pc_on_block_instr 0002 -> 0000
21 done

# Block output.
edb3 otir
 0 m1_fetch
 0   fetch ed at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 m1_fetch
 4   fetch b3 at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 get_c 00
 8 get_b 00
 8 get_l 00
 8 get_h 00
 8 get_f 00
 8 fetch_cycle_extra_1t
 9 read ed at 0000
 9   set_addr_bus 0001 -> 0000
11   mreq_wait 0000
12 output ed at ff00
12   set_addr_bus 0000 -> ff00
15   iorq_wait ff00
16 set_c 00 -> 00
16 set_b 00 -> ff
16 set_wz 0000 -> ff01
16 set_l 00 -> 01
16 set_h 00 -> 00
16 set_f 00 -> ae
16 5t_exec
21 get_pc_on_block_instr 0002
21 set_pc_on_block_instr 0002 -> 0000
21 done

# OUT (n), r
d3ab out (0xab), a
 0 m1_fetch
 0   fetch d3 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 imm8_read ab at 0001
 4   get_pc_on_imm8_read 0001
 4   read ab at 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 7   set_pc_on_imm8_read 0001 -> 0002
 7 get_a 00
 7 output 00 at 00ab
 7   set_addr_bus 0001 -> 00ab
10   iorq_wait 00ab
11 set_wz 0000 -> 00ac
11 done

# POP rp2
c1 pop bc
 0 m1_fetch
 0   fetch c1 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 get_sp 0000
 4 read c1 at 0000
 4   set_addr_bus 0000 -> 0000
 6   mreq_wait 0000
 7 read 00 at 0001
 7   set_addr_bus 0000 -> 0001
 9   mreq_wait 0001
10 set_sp 0000 -> 0002
10 set_c 00 -> c1
10 set_b 00 -> 00
10 done

# PUSH rp2
c5 push bc
 0 m1_fetch
 0   fetch c5 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 fetch_cycle_extra_1t
 5 get_c 00
 5 get_b 00
 5 get_sp 0000
 5 write 00 -> 00 at ffff
 5   set_addr_bus 0000 -> ffff
 7   mreq_wait ffff
 8 write 00 -> 00 at fffe
 8   set_addr_bus ffff -> fffe
10   mreq_wait fffe
11 set_sp 0000 -> fffe
11 done

# rot r
cb00 rlc b
 0 m1_fetch
 0   fetch cb at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 m1_fetch
 4   fetch 00 at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 get_b 00
 8 get_f 00
 8 set_b 00 -> 00
 8 set_f 00 -> 44
 8 done

cb23 sla e
 0 m1_fetch
 0   fetch cb at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 m1_fetch
 4   fetch 23 at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 get_e 00
 8 get_f 00
 8 set_e 00 -> 00
 8 set_f 00 -> 44
 8 done

cb3c srl h
 0 m1_fetch
 0   fetch cb at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 m1_fetch
 4   fetch 3c at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 get_h 00
 8 get_f 00
 8 set_h 00 -> 00
 8 set_f 00 -> 44
 8 done

ddcb463e srl (ix + 70)
 0 m1_fetch
 0   fetch dd at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 set_index_rp hl -> ix
 4 disable_int
 4 m1_fetch
 4   fetch cb at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 disp_read 46 at 0002
 8   get_pc_on_disp_read 0002
 8   read 46 at 0002
 8     set_addr_bus 0001 -> 0002
10     mreq_wait 0002
11   set_pc_on_disp_read 0002 -> 0003
11 fetch 3e at 0003
11   get_pc_on_fetch 0003
11   set_addr_bus 0002 -> 0003
13   mreq_wait 0003
13   get_ir_on_refresh 0002
13   set_addr_bus 0003 -> 0002
15   set_pc_on_fetch 0003 -> 0004
15 fetch_cycle_extra_1t
16 get_ixl 00
16 get_ixh 00
16 read 00 at 0046
16   set_addr_bus 0002 -> 0046
18   mreq_wait 0046
19 read_cycle_extra_1t
20 set_wz 0000 -> 0046
20 get_f 00
20 get_ixl 00
20 get_ixh 00
20 write 00 -> 00 at 0046
20   set_addr_bus 0046 -> 0046
22   mreq_wait 0046
23 set_wz 0046 -> 0046
23 set_f 00 -> 44
23 set_index_rp ix -> hl
23 done

# RL r
cb11 rl c
 0 m1_fetch
 0   fetch cb at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 m1_fetch
 4   fetch 11 at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 get_c 00
 8 get_f 00
 8 set_c 00 -> 00
 8 set_f 00 -> 44
 8 done

# RLA
17 rla
 0 m1_fetch
 0   fetch 17 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 get_a 00
 4 get_f 00
 4 set_a 00 -> 00
 4 set_f 00 -> 00
 4 done

# RLCA
07 rlca
 0 m1_fetch
 0   fetch 07 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 get_a 00
 4 get_f 00
 4 set_a 00 -> 00
 4 set_f 00 -> 00
 4 done

# RLD
ed6f rld
 0 m1_fetch
 0   fetch ed at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 m1_fetch
 4   fetch 6f at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 get_a 00
 8 get_f 00
 8 get_l 00
 8 get_h 00
 8 set_wz 0000 -> 0001
 8 read ed at 0000
 8   set_addr_bus 0001 -> 0000
10   mreq_wait 0000
11 4t_exec
15 set_a 00 -> 0e
15 set_f 00 -> 08
15 write ed -> d0 at 0000
15   set_addr_bus 0000 -> 0000
17   mreq_wait 0000
18 done

# RRA
1f rra
 0 m1_fetch
 0   fetch 1f at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 get_a 00
 4 get_f 00
 4 set_a 00 -> 00
 4 set_f 00 -> 00
 4 done

# RRC
cb08 rrc b
 0 m1_fetch
 0   fetch cb at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 m1_fetch
 4   fetch 08 at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 get_b 00
 8 get_f 00
 8 set_b 00 -> 00
 8 set_f 00 -> 44
 8 done

# RRCA
0f rrca
 0 m1_fetch
 0   fetch 0f at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 get_a 00
 4 get_f 00
 4 set_a 00 -> 00
 4 set_f 00 -> 00
 4 done

# RRD
ed67 rrd
 0 m1_fetch
 0   fetch ed at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 m1_fetch
 4   fetch 67 at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 get_a 00
 8 get_f 00
 8 get_l 00
 8 get_h 00
 8 set_wz 0000 -> 0001
 8 read ed at 0000
 8   set_addr_bus 0001 -> 0000
10   mreq_wait 0000
11 4t_exec
15 set_a 00 -> 0d
15 set_f 00 -> 08
15 write ed -> 0e at 0000
15   set_addr_bus 0000 -> 0000
17   mreq_wait 0000
18 done

# RST nn
d7 rst 0x0010
 0 m1_fetch
 0   fetch d7 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 fetch_cycle_extra_1t
 5 get_sp 0000
 5 write 00 -> 00 at ffff
 5   set_addr_bus 0000 -> ffff
 7   mreq_wait ffff
 8 write 00 -> 01 at fffe
 8   set_addr_bus ffff -> fffe
10   mreq_wait fffe
11 set_sp 0000 -> fffe
11 set_wz 0000 -> 0010
11 set_pc_on_call 0001 -> 0010
11 done

# RES b, r
fdcb308e res 1, (iy + 48)
 0 m1_fetch
 0   fetch fd at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 set_index_rp hl -> iy
 4 disable_int
 4 m1_fetch
 4   fetch cb at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 disp_read 30 at 0002
 8   get_pc_on_disp_read 0002
 8   read 30 at 0002
 8     set_addr_bus 0001 -> 0002
10     mreq_wait 0002
11   set_pc_on_disp_read 0002 -> 0003
11 fetch 8e at 0003
11   get_pc_on_fetch 0003
11   set_addr_bus 0002 -> 0003
13   mreq_wait 0003
13   get_ir_on_refresh 0002
13   set_addr_bus 0003 -> 0002
15   set_pc_on_fetch 0003 -> 0004
15 fetch_cycle_extra_1t
16 get_iyl 00
16 get_iyh 00
16 read 00 at 0030
16   set_addr_bus 0002 -> 0030
18   mreq_wait 0030
19 read_cycle_extra_1t
20 set_wz 0000 -> 0030
20 get_iyl 00
20 get_iyh 00
20 write 00 -> 00 at 0030
20   set_addr_bus 0030 -> 0030
22   mreq_wait 0030
23 set_wz 0030 -> 0030
23 set_index_rp iy -> hl
23 done

# RET
c9 ret
 0 m1_fetch
 0   fetch c9 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 get_sp 0000
 4 read c9 at 0000
 4   set_addr_bus 0000 -> 0000
 6   mreq_wait 0000
 7 read 00 at 0001
 7   set_addr_bus 0000 -> 0001
 9   mreq_wait 0001
10 set_sp 0000 -> 0002
10 set_wz 0000 -> 00c9
10 set_pc_on_return 0001 -> 00c9
10 done

# RET cc
c0 ret nz
 0 m1_fetch
 0   fetch c0 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 fetch_cycle_extra_1t
 5 get_f 00
 5 get_sp 0000
 5 read c0 at 0000
 5   set_addr_bus 0000 -> 0000
 7   mreq_wait 0000
 8 read 00 at 0001
 8   set_addr_bus 0000 -> 0001
10   mreq_wait 0001
11 set_sp 0000 -> 0002
11 set_wz 0000 -> 00c0
11 set_pc_on_return 0001 -> 00c0
11 done

# RETI
ed4d reti
 0 m1_fetch
 0   fetch ed at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 m1_fetch
 4   fetch 4d at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 get_sp 0000
 8 read ed at 0000
 8   set_addr_bus 0001 -> 0000
10   mreq_wait 0000
11 read 4d at 0001
11   set_addr_bus 0000 -> 0001
13   mreq_wait 0001
14 set_sp 0000 -> 0002
14 set_wz 0000 -> 4ded
14 set_pc_on_return 0002 -> 4ded
14 done

# RETN
ed45 retn
 0 m1_fetch
 0   fetch ed at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 m1_fetch
 4   fetch 45 at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 get_sp 0000
 8 read ed at 0000
 8   set_addr_bus 0001 -> 0000
10   mreq_wait 0000
11 read 45 at 0001
11   set_addr_bus 0000 -> 0001
13   mreq_wait 0001
14 set_sp 0000 -> 0002
14 set_wz 0000 -> 45ed
14 set_pc_on_return 0002 -> 45ed
14 done

ed55 xretn 0x55
ed5d xretn 0x5d
ed65 xretn 0x65
ed6d xretn 0x6d
ed75 xretn 0x75
ed7d xretn 0x7d

# RR
cb18 rr b
 0 m1_fetch
 0   fetch cb at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 m1_fetch
 4   fetch 18 at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 get_b 00
 8 get_f 00
 8 set_b 00 -> 00
 8 set_f 00 -> 44
 8 done

# SBC r
9f sbc a, a
 0 m1_fetch
 0   fetch 9f at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 get_a 00
 4 get_a 00
 4 get_f 00
 4 set_a 00 -> 00
 4 set_f 00 -> 42
 4 done

# SBC HL, rp
ed52 sbc hl, de
 0 m1_fetch
 0   fetch ed at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 m1_fetch
 4   fetch 52 at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 get_l 00
 8 get_h 00
 8 get_e 00
 8 get_d 00
 8 get_f 00
 8 4t_exec
12 3t_exec
15 set_wz 0000 -> 0001
15 set_l 00 -> 00
15 set_h 00 -> 00
15 set_f 00 -> 42
15 done

# SCF
37 scf
 0 m1_fetch
 0   fetch 37 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 get_a 00
 4 get_f 00
 4 set_f 00 -> 01
 4 done

# SET b, r
fdcb01ce set 1, (iy + 1)
 0 m1_fetch
 0   fetch fd at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 set_index_rp hl -> iy
 4 disable_int
 4 m1_fetch
 4   fetch cb at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 disp_read 01 at 0002
 8   get_pc_on_disp_read 0002
 8   read 01 at 0002
 8     set_addr_bus 0001 -> 0002
10     mreq_wait 0002
11   set_pc_on_disp_read 0002 -> 0003
11 fetch ce at 0003
11   get_pc_on_fetch 0003
11   set_addr_bus 0002 -> 0003
13   mreq_wait 0003
13   get_ir_on_refresh 0002
13   set_addr_bus 0003 -> 0002
15   set_pc_on_fetch 0003 -> 0004
15 fetch_cycle_extra_1t
16 get_iyl 00
16 get_iyh 00
16 read cb at 0001
16   set_addr_bus 0002 -> 0001
18   mreq_wait 0001
19 read_cycle_extra_1t
20 set_wz 0000 -> 0001
20 get_iyl 00
20 get_iyh 00
20 write cb -> cb at 0001
20   set_addr_bus 0001 -> 0001
22   mreq_wait 0001
23 set_wz 0001 -> 0001
23 set_index_rp iy -> hl
23 done

# SLL r
cb30 sll b
 0 m1_fetch
 0   fetch cb at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 m1_fetch
 4   fetch 30 at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 get_b 00
 8 get_f 00
 8 set_b 00 -> 01
 8 set_f 00 -> 00
 8 done

# Test that CF is computed from the original value of the operand.
.b=80
cb30 sll b
...
 8 set_b 80 -> 01
 8 set_f 00 -> 01
 8 done

# SRA r
cb28 sra b
 0 m1_fetch
 0   fetch cb at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 m1_fetch
 4   fetch 28 at 0001
 4     get_pc_on_fetch 0001
 4     set_addr_bus 0000 -> 0001
 6     mreq_wait 0001
 6     get_ir_on_refresh 0001
 6     set_addr_bus 0001 -> 0001
 8     set_pc_on_fetch 0001 -> 0002
 8   set_r 01 -> 02
 8 get_b 00
 8 get_f 00
 8 set_b 00 -> 00
 8 set_f 00 -> 44
 8 done

# Test that CF is computed from the original value of the operand.
.b=01
cb28 sra b
...
 8 set_b 01 -> 00
 8 set_f 00 -> 45
 8 done

# SUB r
91 sub c
 0 m1_fetch
 0   fetch 91 at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 get_c 00
 4 get_a 00
 4 set_a 00 -> 00
 4 set_f 00 -> 42
 4 done

# XOR r
af xor a
 0 m1_fetch
 0   fetch af at 0000
 0     get_pc_on_fetch 0000
 0     set_addr_bus 0000 -> 0000
 2     mreq_wait 0000
 2     get_ir_on_refresh 0000
 2     set_addr_bus 0000 -> 0000
 4     set_pc_on_fetch 0000 -> 0001
 4   set_r 00 -> 01
 4 get_a 00
 4 get_a 00
 4 set_a 00 -> 00
 4 set_f 00 -> 44
 4 done

# All instructions.
00 nop
010000 ld bc, 0x0000
02 ld (bc), a
03 inc bc
04 inc b
05 dec b
0600 ld b, 0x00
07 rlca
08 ex af, af'
09 add hl, bc
0a ld a, (bc)
0b dec bc
0c inc c
0d dec c
0e00 ld c, 0x00
0f rrca
1000 djnz $ + 2
110000 ld de, 0x0000
12 ld (de), a
13 inc de
14 inc d
15 dec d
1600 ld d, 0x00
17 rla
1800 jr $ + 2
19 add hl, de
1a ld a, (de)
1b dec de
1c inc e
1d dec e
1e00 ld e, 0x00
1f rra
2000 jr nz, $ + 2
210000 ld hl, 0x0000
220000 ld (0x0000), hl
23 inc hl
24 inc h
25 dec h
2600 ld h, 0x00
27 daa
2800 jr z, $ + 2
29 add hl, hl
2a0000 ld hl, (0x0000)
2b dec hl
2c inc l
2d dec l
2e00 ld l, 0x00
2f cpl
3000 jr nc, $ + 2
310000 ld sp, 0x0000
320000 ld (0x0000), a
33 inc sp
34 inc (hl)
35 dec (hl)
3600 ld (hl), 0x00
37 scf
3800 jr c, $ + 2
39 add hl, sp
3a0000 ld a, (0x0000)
3b dec sp
3c inc a
3d dec a
3e00 ld a, 0x00
3f ccf
40 ld b, b
41 ld b, c
42 ld b, d
43 ld b, e
44 ld b, h
45 ld b, l
46 ld b, (hl)
47 ld b, a
48 ld c, b
49 ld c, c
4a ld c, d
4b ld c, e
4c ld c, h
4d ld c, l
4e ld c, (hl)
4f ld c, a
50 ld d, b
51 ld d, c
52 ld d, d
53 ld d, e
54 ld d, h
55 ld d, l
56 ld d, (hl)
57 ld d, a
58 ld e, b
59 ld e, c
5a ld e, d
5b ld e, e
5c ld e, h
5d ld e, l
5e ld e, (hl)
5f ld e, a
60 ld h, b
61 ld h, c
62 ld h, d
63 ld h, e
64 ld h, h
65 ld h, l
66 ld h, (hl)
67 ld h, a
68 ld l, b
69 ld l, c
6a ld l, d
6b ld l, e
6c ld l, h
6d ld l, l
6e ld l, (hl)
6f ld l, a
70 ld (hl), b
71 ld (hl), c
72 ld (hl), d
73 ld (hl), e
74 ld (hl), h
75 ld (hl), l
76 halt
77 ld (hl), a
78 ld a, b
79 ld a, c
7a ld a, d
7b ld a, e
7c ld a, h
7d ld a, l
7e ld a, (hl)
7f ld a, a
80 add a, b
81 add a, c
82 add a, d
83 add a, e
84 add a, h
85 add a, l
86 add a, (hl)
87 add a, a
88 adc a, b
89 adc a, c
8a adc a, d
8b adc a, e
8c adc a, h
8d adc a, l
8e adc a, (hl)
8f adc a, a
90 sub b
91 sub c
92 sub d
93 sub e
94 sub h
95 sub l
96 sub (hl)
97 sub a
98 sbc a, b
99 sbc a, c
9a sbc a, d
9b sbc a, e
9c sbc a, h
9d sbc a, l
9e sbc a, (hl)
9f sbc a, a
a0 and b
a1 and c
a2 and d
a3 and e
a4 and h
a5 and l
a6 and (hl)
a7 and a
a8 xor b
a9 xor c
aa xor d
ab xor e
ac xor h
ad xor l
ae xor (hl)
af xor a
b0 or b
b1 or c
b2 or d
b3 or e
b4 or h
b5 or l
b6 or (hl)
b7 or a
b8 cp b
b9 cp c
ba cp d
bb cp e
bc cp h
bd cp l
be cp (hl)
bf cp a
c0 ret nz
c1 pop bc
c20000 jp nz, 0x0000
c30000 jp 0x0000
c40000 call nz, 0x0000
c5 push bc
c600 add a, 0x00
c7 rst 0x0000
c8 ret z
c9 ret
ca0000 jp z, 0x0000

cb00 rlc b
cb01 rlc c
cb02 rlc d
cb03 rlc e
cb04 rlc h
cb05 rlc l
cb06 rlc (hl)
cb07 rlc a
cb08 rrc b
cb09 rrc c
cb0a rrc d
cb0b rrc e
cb0c rrc h
cb0d rrc l
cb0e rrc (hl)
cb0f rrc a
cb10 rl b
cb11 rl c
cb12 rl d
cb13 rl e
cb14 rl h
cb15 rl l
cb16 rl (hl)
cb17 rl a
cb18 rr b
cb19 rr c
cb1a rr d
cb1b rr e
cb1c rr h
cb1d rr l
cb1e rr (hl)
cb1f rr a
cb20 sla b
cb21 sla c
cb22 sla d
cb23 sla e
cb24 sla h
cb25 sla l
cb26 sla (hl)
cb27 sla a
cb28 sra b
cb29 sra c
cb2a sra d
cb2b sra e
cb2c sra h
cb2d sra l
cb2e sra (hl)
cb2f sra a
cb30 sll b
cb31 sll c
cb32 sll d
cb33 sll e
cb34 sll h
cb35 sll l
cb36 sll (hl)
cb37 sll a
cb38 srl b
cb39 srl c
cb3a srl d
cb3b srl e
cb3c srl h
cb3d srl l
cb3e srl (hl)
cb3f srl a
cb40 bit 0, b
cb41 bit 0, c
cb42 bit 0, d
cb43 bit 0, e
cb44 bit 0, h
cb45 bit 0, l
cb46 bit 0, (hl)
cb47 bit 0, a
cb48 bit 1, b
cb49 bit 1, c
cb4a bit 1, d
cb4b bit 1, e
cb4c bit 1, h
cb4d bit 1, l
cb4e bit 1, (hl)
cb4f bit 1, a
cb50 bit 2, b
cb51 bit 2, c
cb52 bit 2, d
cb53 bit 2, e
cb54 bit 2, h
cb55 bit 2, l
cb56 bit 2, (hl)
cb57 bit 2, a
cb58 bit 3, b
cb59 bit 3, c
cb5a bit 3, d
cb5b bit 3, e
cb5c bit 3, h
cb5d bit 3, l
cb5e bit 3, (hl)
cb5f bit 3, a
cb60 bit 4, b
cb61 bit 4, c
cb62 bit 4, d
cb63 bit 4, e
cb64 bit 4, h
cb65 bit 4, l
cb66 bit 4, (hl)
cb67 bit 4, a
cb68 bit 5, b
cb69 bit 5, c
cb6a bit 5, d
cb6b bit 5, e
cb6c bit 5, h
cb6d bit 5, l
cb6e bit 5, (hl)
cb6f bit 5, a
cb70 bit 6, b
cb71 bit 6, c
cb72 bit 6, d
cb73 bit 6, e
cb74 bit 6, h
cb75 bit 6, l
cb76 bit 6, (hl)
cb77 bit 6, a
cb78 bit 7, b
cb79 bit 7, c
cb7a bit 7, d
cb7b bit 7, e
cb7c bit 7, h
cb7d bit 7, l
cb7e bit 7, (hl)
cb7f bit 7, a
cb80 res 0, b
cb81 res 0, c
cb82 res 0, d
cb83 res 0, e
cb84 res 0, h
cb85 res 0, l
cb86 res 0, (hl)
cb87 res 0, a
cb88 res 1, b
cb89 res 1, c
cb8a res 1, d
cb8b res 1, e
cb8c res 1, h
cb8d res 1, l
cb8e res 1, (hl)
cb8f res 1, a
cb90 res 2, b
cb91 res 2, c
cb92 res 2, d
cb93 res 2, e
cb94 res 2, h
cb95 res 2, l
cb96 res 2, (hl)
cb97 res 2, a
cb98 res 3, b
cb99 res 3, c
cb9a res 3, d
cb9b res 3, e
cb9c res 3, h
cb9d res 3, l
cb9e res 3, (hl)
cb9f res 3, a
cba0 res 4, b
cba1 res 4, c
cba2 res 4, d
cba3 res 4, e
cba4 res 4, h
cba5 res 4, l
cba6 res 4, (hl)
cba7 res 4, a
cba8 res 5, b
cba9 res 5, c
cbaa res 5, d
cbab res 5, e
cbac res 5, h
cbad res 5, l
cbae res 5, (hl)
cbaf res 5, a
cbb0 res 6, b
cbb1 res 6, c
cbb2 res 6, d
cbb3 res 6, e
cbb4 res 6, h
cbb5 res 6, l
cbb6 res 6, (hl)
cbb7 res 6, a
cbb8 res 7, b
cbb9 res 7, c
cbba res 7, d
cbbb res 7, e
cbbc res 7, h
cbbd res 7, l
cbbe res 7, (hl)
cbbf res 7, a
cbc0 set 0, b
cbc1 set 0, c
cbc2 set 0, d
cbc3 set 0, e
cbc4 set 0, h
cbc5 set 0, l
cbc6 set 0, (hl)
cbc7 set 0, a
cbc8 set 1, b
cbc9 set 1, c
cbca set 1, d
cbcb set 1, e
cbcc set 1, h
cbcd set 1, l
cbce set 1, (hl)
cbcf set 1, a
cbd0 set 2, b
cbd1 set 2, c
cbd2 set 2, d
cbd3 set 2, e
cbd4 set 2, h
cbd5 set 2, l
cbd6 set 2, (hl)
cbd7 set 2, a
cbd8 set 3, b
cbd9 set 3, c
cbda set 3, d
cbdb set 3, e
cbdc set 3, h
cbdd set 3, l
cbde set 3, (hl)
cbdf set 3, a
cbe0 set 4, b
cbe1 set 4, c
cbe2 set 4, d
cbe3 set 4, e
cbe4 set 4, h
cbe5 set 4, l
cbe6 set 4, (hl)
cbe7 set 4, a
cbe8 set 5, b
cbe9 set 5, c
cbea set 5, d
cbeb set 5, e
cbec set 5, h
cbed set 5, l
cbee set 5, (hl)
cbef set 5, a
cbf0 set 6, b
cbf1 set 6, c
cbf2 set 6, d
cbf3 set 6, e
cbf4 set 6, h
cbf5 set 6, l
cbf6 set 6, (hl)
cbf7 set 6, a
cbf8 set 7, b
cbf9 set 7, c
cbfa set 7, d
cbfb set 7, e
cbfc set 7, h
cbfd set 7, l
cbfe set 7, (hl)
cbff set 7, a

cc0000 call z, 0x0000
cd0000 call 0x0000
ce00 adc a, 0x00
cf rst 0x0008
d0 ret nc
d1 pop de
d20000 jp nc, 0x0000
d300 out (0x00), a
d40000 call nc, 0x0000
d5 push de
d600 sub 0x00
d7 rst 0x0010
d8 ret c
d9 exx
da0000 jp c, 0x0000
db00 in a, (0x00)
dc0000 call c, 0x0000

# TODO: dd

de00 sbc a, 0x00
df rst 0x0018
e0 ret po
e1 pop hl
e20000 jp po, 0x0000
e3 ex (sp), hl
e40000 call po, 0x0000
e5 push hl
e600 and 0x00
e7 rst 0x0020
e8 ret pe
e9 jp (hl)
ea0000 jp pe, 0x0000
eb ex de, hl
ec0000 call pe, 0x0000

# TODO: ed

ee00 xor 0x00
ef rst 0x0028
f0 ret p
f1 pop af
f20000 jp p, 0x0000
f3 di
f40000 call p, 0x0000
f5 push af
f600 or 0x00
f7 rst 0x0030
f8 ret m
f9 ld sp, hl
fa0000 jp m, 0x0000
fb ei
fc0000 call m, 0x0000

# TODO: fd

fe00 cp 0x00
ff rst 0x0038
